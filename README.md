# embedded-experiments
assignments for the course _Embedded System and the Software Tools_

- 李肇阳
- 2014013432
- 2016-12-21

_34100344：计算机与网络体系结构（2）之嵌入式系统及其软件工具_
* 2016-2017 学年秋季学期
* 樊海宁，清华大学软件学院



### 51单片机大作业

#### 实验要求

> 在试验板上实现包含中断服务程序的汇编小程序，程序内容自己依据板上资源自定，要求有保护现场的代码。

> * 编写汇编程序，通过按键实现中断功能。
> * 按键激活中断，执行中断代码。
> * 要求要在开发板已有资源体现出主程序与中断程序同时运行。


#### 所做工作

实现了两个计数器，分别用两位数码管显示。其中之一定时增，另一在按下按键时增，互不干扰。

处理了定时器 0 溢出中断、外部中断 0、外部中断 1 这三种中断，其中后两者共用同一中断处理程序。定时器中断处理程序中修改变量 `COUNTERX` 的值，外部中断处理程序中修改计数器 `COUNTERY` 的值。

为获得较大的时间间隔，在定时器中断处理程序中用 `COUNTERT` 记录已发生溢出中断的次数，每当发生定时器溢出中断增之，仅当其值达到某阈值，修改 `COUNTERX` 并清零之。

为避免按一下按钮数字蹦好几个，即外部中断在短时间内被反复触发的情况，增设了一个名为 `BUTTONDOWN` 的变量，由定时器中断减、外部中断加。

主循环中进行数字显示，即依次在数码管的两位上显示 `COUNTERX`、`COUNTERY`，反复快速切换。其中用到的短延迟为一自减循环。七段数字译码表放在地址 `DIGITS_TABLE` 处。

### ARM大作业

#### 实验要求

> 阅读eCos相关文献，了解其中断服务程序编程模式，在试验板上每人实现包含中断服务程序的汇编或C小程序，程序内容自己依据板上资源自定。

#### 所做工作

实现了实验板上 4 只 LED 灯依次点亮、熄灭，以顺时针或逆时针顺序。每当按键，顺序改变。

注册按键触发的外部中断 0，其 ISR 什么都不做，其 DSR 修改顺时针/逆时针顺序标记，并改变索引数组指针的值。

主循环按照索引数组依次点亮、熄灭各灯。

#### 参考资料

主要参考了以下两份来自 eCos 官网的文档：

* [eCos Interrupt Model](http://ecos.sourceware.org/docs-1.3.1/ref/ecos-ref.c.html)
* [Interrupt Handling](http://ecos.sourceware.org/docs-2.0/ref/kernel-interrupts.html)
